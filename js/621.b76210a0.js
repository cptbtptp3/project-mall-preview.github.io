"use strict";(self["webpackChunkproj_mall"]=self["webpackChunkproj_mall"]||[]).push([[621],{2085:function(t,e,s){s.d(e,{Z:function(){return c}});var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"tab-control"},t._l(t.titles,(function(s,r){return e("div",{staticClass:"tab-control-item",class:{active:t.currentIndex===r},on:{click:function(e){return t.itemClick(r)}}},[e("span",[t._v(t._s(s))])])})),0)},a=[],i={name:"TabControl",props:{titles:{type:Array,default(){return[]}}},data(){return{currentIndex:0}},methods:{itemClick(t){this.currentIndex=t,this.$emit("tabClick",t)}}},n=i,o=s(1001),l=(0,o.Z)(n,r,a,!1,null,"34d78f7a",null),c=l.exports},2271:function(t,e,s){s.r(e),s.d(e,{default:function(){return R}});var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"wrapper"},[e("nav-bar",{staticClass:"nav-bar",scopedSlots:t._u([{key:"center",fn:function(){return[t._v("商品分类")]},proxy:!0}])}),e("div",{staticClass:"content"},[e("category-menu",{attrs:{categories:t.categories},on:{selectItem:t.selectItem}}),e("scroll",{ref:"scroll",staticClass:"tab-content",attrs:{data:[t.categoryData],"probe-type":3,observeDOM:!0,"observe-image":!0},on:{scroll:t.scroll}},[e("div",[e("menu-detail",{attrs:{subcategories:t.showSubcategory}}),e("content-detail",{attrs:{"content-detail":t.showContentDetail}})],1)])],1),e("back-top",{directives:[{name:"show",rawName:"v-show",value:t.showTop,expression:"showTop"}],nativeOn:{click:function(e){return t.backTop.apply(null,arguments)}}})],1)},a=[],i=s(4850),n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"menu"},[e("scroll",{ref:"=scroll",staticClass:"content",attrs:{observeDOM:!0,"observe-image":!0}},t._l(t.categories,(function(s,r){return e("div",{key:r,staticClass:"title",class:{active:r===t.currentIndex},on:{click:function(e){return t.titleClick(r)}}},[t._v(" "+t._s(s.title))])})),0)],1)},o=[],l=s(1347),c={name:"CategoryMenu",components:{Scroll:l.Z},props:{categories:Array},data(){return{currentIndex:0}},methods:{titleClick(t){this.currentIndex=t,this.$emit("selectItem",t)}}},u=c,h=s(1001),g=(0,h.Z)(u,n,o,!1,null,"785fbcc4",null),p=g.exports,d=function(){var t=this,e=t._self._c;return e("div",[t.subcategories.list?e("grid-view",{staticClass:"grid",attrs:{cols:3,lineSpace:15,"v-margin":20}},t._l(t.subcategories.list,(function(s,r){return e("div",{key:r,staticClass:"menu-detail"},[e("a",{attrs:{href:s.link}}),e("img",{staticClass:"image",attrs:{src:s.image,alt:""}}),e("div",{staticClass:"text"},[t._v(t._s(s.title))])])})),0):t._e()],1)},y=[],m=function(){var t=this,e=t._self._c;return e("div",{ref:"gridView",staticClass:"grid-view"},[t._t("default")],2)},f=[],v={name:"GridView",props:{cols:{type:Number,default:2},hMargin:{type:Number,default:8},vMargin:{type:Number,default:8},itemSpace:{type:Number,default:8},lineSpace:{type:Number,default:8}},mounted(){setTimeout(this._autoLayout,20)},updated(){this._autoLayout()},methods:{_autoLayout(){let t=this.$refs.gridView,e=t.children;t.style.padding=`${this.vMargin}px ${this.hMargin}px`;let s=(t.clientWidth-2*this.hMargin-this.cols*this.itemSpace)/this.cols;for(let r=0;r<e.length;r++){let t=e[r];t.style.width=s+"px",(r+1)%this.cols!==0&&(t.style.marginRight=this.itemSpace+"px"),r>=this.cols&&(t.style.marginTop=this.lineSpace+"px")}}}},b=v,_=(0,h.Z)(b,m,f,!1,null,null,null),C=_.exports,x={name:"MenuDetail",props:{subcategories:Object},components:{GridView:C}},D=x,w=(0,h.Z)(D,d,y,!1,null,"6d375afc",null),k=w.exports,I=function(){var t=this,e=t._self._c;return e("grid-view",t._l(t.contentDetail,(function(t,s){return e("goods-list-item",{key:s,attrs:{goodsItem:t}})})),1)},T=[],Z=s(7405),M={name:"ContentDetail",components:{GridView:C,GoodsListItem:Z.Z},props:{contentDetail:Array}},S=M,N=(0,h.Z)(S,I,T,!1,null,null,null),W=N.exports,V=s(2085),$=s(3013);function G(){return(0,$.W)({url:"/category"})}function L(t){return(0,$.W)({url:"/subcategory",params:{maitKey:t}})}function O(t,e){return(0,$.W)({url:"/subcategory/detail",params:{miniWallkey:t,type:e}})}var j=s(5095),A={name:"Category",components:{NavBar:i.Z,CategoryMenu:p,MenuDetail:k,ContentDetail:W,Scroll:l.Z,TabControl:V.Z},data(){return{categories:[],categoryData:[],currentIndex:-1,currentType:"pop"}},mixins:[j.s],created(){this._getCategory()},computed:{showSubcategory(){return-1===this.currentIndex?{}:this.categoryData[this.currentIndex].subcategories},showContentDetail(){return-1===this.currentIndex?[]:this.categoryData[this.currentIndex].categoryDetail[this.currentType]}},methods:{_getCategory(){G().then((t=>{console.log(t),this.categories=t.data.category.list;for(let e=0;e<this.categories.length;e++)this.categoryData[e]={subcategories:{},categoryDetail:{pop:[],new:[],sell:[]}};this._getsubcategory(0)}))},_getsubcategory(t){this.currentIndex=t;const e=this.categories[t].maitKey;L(e).then((e=>{console.log(e),this.categoryData[t].subcategories=e.data,this.categoryData={...this.categoryData},this._getContentDetail("pop"),this._getContentDetail("new"),this._getContentDetail("sell"),console.log(this.categoryData)}))},_getContentDetail(t){const e=this.categories[this.currentIndex].miniWallkey;console.log(e),O(e,t).then((e=>{this.categoryData[this.currentIndex].categoryDetail[t]=e,this.categoryData={...this.categoryData}}))},tabClick(t){switch(t){case 0:this.currentType="pop";break;case 1:this.currentType="new";break;case 2:this.currentType="sell";break}console.log(this.currentType)},selectItem(t){this._getsubcategory(t)},scroll(t){const e=-t.y;this.showTop=e>1e3}}},K=A,B=(0,h.Z)(K,r,a,!1,null,"599e5792",null),R=B.exports}}]);
//# sourceMappingURL=621.b76210a0.js.map